{% extends 'menu.html' %}
{% load static %}

{% block title %}Inicio{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/inicio.css' %}">
<link rel="stylesheet" href="{% static 'css/carrusel.css' %}">

<div class="container my-5">
  <!-- MENSAJE DE BIENVENIDA -->
  {% if activo %}
  <div class="welcome-banner logged-in">
    <div class="container">
      <div class="welcome-content">
        <div class="welcome-icon">
          <i class="bi bi-heart-fill"></i>
        </div>
        <div class="welcome-text">
          <p>Florece donde la vida te plante, y embellece al mundo con tu esencia.</p>
          <h4>¬°Hola, {{request.session.nombre_cliente}}! Bienvenido</h4>
          <p>Nos alegra tenerte de vuelta. Descubre nuestras nuevas creaciones florales especialmente para ti.</p>
        </div>
      </div>
    </div>
  </div>
  {% else %}
  <div class="welcome-banner guest">
    <div class="container">
      <div class="welcome-content">
        <div class="welcome-icon">
          <i class="bi bi-flower2"></i>
        </div>
        <div class="welcome-text">
          <p>Cuando las palabras faltan, un ramo habla por ti.</p>
          <h4>Bienvenido a Flowers Today</h4>
          <p>Nuestras flores son mensajeras de tus emociones m√°s profundas. ¬°Descubre la belleza de la naturaleza con nosotros! üíê</p>
        </div>
      </div>
    </div>
  </div>
  {% endif %}

  <!-- PRODUCTOS POR CATEGOR√çA -->
  {% for categoria in categorias %}
    <h3 class="text-white mb-4 text-center">{{ categoria.nombre_categoria }}</h3>

    <div class="carousel-wrapper my-4">
      <!-- Flecha izquierda -->
      <button class="btn btn-light shadow carousel-btn left"
              onclick="scrollCarousel('carousel-{{ forloop.counter }}', -1)">
        <i class="bi bi-chevron-left"></i>
      </button>

      <!-- Contenedor de productos -->
      <div id="carousel-{{ forloop.counter }}" class="carousel-container d-flex overflow-x-auto">
        {% for producto in productos %}
          {% if producto.id_categoria.nombre_categoria == categoria.nombre_categoria %}
            <!-- Tarjeta con clase uniform-card -->
            <div class="card uniform-card text-center shadow me-3 flex-shrink-0">
              <img src="{% if producto.imagen_producto %}{{producto.imagen_producto.url}}{% else %}{% static 'img/producto-default.png'%}{% endif %}" 
                   class="card-img-top producto-img" 
                   alt="{{ producto.nombre_producto }}">
              <div class="card-body bg-white">
                <h5 class="card-title">{{ producto.nombre_producto }}</h5>
                <p class="card-text">{{ producto.descripcion_producto }}</p>
                <p class="fw-bold">Precio: ${{ producto.precio_producto }}</p>
                <div class="carrito-control d-flex justify-content-center">
                  <button class="btn btn-agregar d-flex align-items-center bi bi-cart3"
                    style="background-color: #6C2DC7; color: white;"
                    data-id="{{producto.id_producto}}"
                    data-nombre="{{producto.nombre_producto}}"
                    data-imagen = "{% if producto.imagen_producto%}{{producto.imagen_producto.url}}{% else %}{% static 'img/producto-default.png' %}{% endif %}"
                    data-precio = "{{producto.precio_producto}}"
                    data-descripcion="{{producto.descripcion_producto}}"
                    >
                    Agregar al Carrito
                  </button>
                </div>
              </div>
            </div>
          {% endif %}
        {% endfor %}
      </div>

      <!-- Flecha derecha -->
      <button class="btn btn-light shadow carousel-btn right"
              onclick="scrollCarousel('carousel-{{ forloop.counter }}', 1)">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  {% endfor %}
</div>

{% endblock %}

{% block footer %}
  {% include 'footer.html' %}
{% endblock %}

{% block scripts %}
<script src="{% static 'js/carritoState.js' %}"></script>
<script src="{% static 'js/carrusel.js' %}"></script>
{% endblock %}