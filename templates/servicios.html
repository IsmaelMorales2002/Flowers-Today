{% extends 'menu.html' %}
{% load static %}
{% block title %}Servicio Personalizado{% endblock %}

{% block content %}
<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-6 col-md-8">

      <div class="card shadow-lg border-0 rounded-4">
        <div class="card-header text-white text-center rounded-top-4" style="background-color: #6C2DC7;">
          <h4 class="mb-0"><i class="bi bi-brush me-2"></i>Servicio Personalizado</h4>
        </div>

        <div class="card-body p-4">
          <!-- FORMULARIO SERVICIO PERSONALIZADO (Cliente) -->
          <form 
            method="POST" 
            action="{% if activo %}{% url 'CrearServicio' %}{% else %}#{% endif %}"
          >
            {% csrf_token %}

            <!-- Categor√≠a -->
            <div class="mb-3">
              <label for="categoria" class="form-label fw-bold">Categor√≠a del servicio</label>
              <select id="categoria" name="categoriaServicio" class="form-select" required {% if not activo %}disabled{% endif %}>
                <option value="" disabled selected>Seleccione una categor√≠a</option>
                {% for cat in categorias %}
                <option value="{{cat.id_categoria_servicio}}">{{cat.nombre_categoria_servicio}}</option>
                {% endfor %}
              </select>
            </div>

            <!-- Descripci√≥n del servicio -->
            <div class="mb-3">
              <label for="descripcion" class="form-label fw-bold">Descripci√≥n del servicio</label>
              <textarea 
                id="descripcion" 
                name="descripcion"
                class="form-control" 
                rows="4" 
                maxlength="145"
                placeholder="Ej: Quiero un arreglo con rosas rojas y blancas para aniversario‚Ä¶" 
                required
                {% if not activo %}disabled{% endif %}
              ></textarea>
            </div>

            <!-- Cantidad de arreglos -->
            <div class="mb-3">
              <label for="cantidad" class="form-label fw-bold">Cantidad de arreglos</label>
              <input 
                type="number" 
                id="cantidad" 
                name="cantidad" 
                class="form-control" 
                min="1" 
                step="1" 
                placeholder="Ejemplo: 3" 
                required
                {% if not activo %}disabled{% endif %}
              >
            </div>

            <p class="text-muted small mb-3">
              ‚úÖ El administrador evaluar√° tu solicitud y se pondr√° en contacto contigo üì©
            </p>

            <!-- Bot√≥n Enviar -->
            <div class="text-center mt-4">
              <button 
                type="{% if activo %}submit{% else %}button{% endif %}" 
                class="btn px-4 py-2 rounded-pill text-white"
                style="background-color: #6C2DC7;"
                {% if not activo %}data-bs-toggle="modal" data-bs-target="#modalLoginServicio"{% endif %}
              >
                <i class="bi bi-send-fill me-1"></i>Enviar solicitud
              </button>
            </div>

          </form>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- MODAL: LOGIN REQUERIDO PARA SERVICIO -->
<div class="modal fade" id="modalLoginServicio" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 rounded-4 shadow-lg">
      <div class="modal-header bg-dark text-white">
        <h5 class="modal-title"><i class="bi bi-person-lock me-2"></i>Inicia sesi√≥n para continuar</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body text-center text-dark">
        <p class="mb-4">Para enviar una solicitud de servicio personalizado, primero debes iniciar sesi√≥n.</p>
        <i class="bi bi-person-circle text-dark display-1 mb-3"></i>
      </div>
      <div class="modal-footer justify-content-center">
        <button class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
        <a href="{% url 'vista_login' %}" class="btn text-white" style="background-color: #6C2DC7;">
          <i class="bi bi-box-arrow-in-right me-1"></i> Iniciar sesi√≥n
        </a>
      </div>
    </div>
  </div>
</div>
{% endblock %}
